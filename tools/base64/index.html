<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Base64 변환 — Yuchani Tools pro</title>
  <meta name="description" content="텍스트·파일을 Base64로 인코딩/디코딩하는 초고속 무료 웹툴. URL-safe, 패딩 제거, 자동감지, 복사/다운로드 지원. 브라우저에서 안전하게 동작." />
  <link rel="canonical" href="https://tools.yuchani.com/base64" />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Yuchani Tools pro" />
  <meta property="og:title" content="Base64 변환 — Yuchani Tools pro" />
  <meta property="og:description" content="텍스트·파일을 Base64로 빠르게 변환하고 디코딩하세요. URL-safe·패딩 옵션 지원." />
  <meta property="og:url" content="https://tools.yuchani.com/base64" />
  <meta property="og:image" content="https://tools.yuchani.com/og/base64.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Base64 변환 — Yuchani Tools pro" />
  <meta name="twitter:description" content="텍스트·파일을 Base64로 빠르게 변환하고 디코딩하세요. URL-safe·패딩 옵션 지원." />
  <meta name="twitter:image" content="https://tools.yuchani.com/og/base64.png" />

  <!-- hreflang (예시) -->
  <link rel="alternate" href="https://tools.yuchani.com/base64" hreflang="ko" />
  <link rel="alternate" href="https://tools.yuchani.com/en/base64" hreflang="en" />
  <link rel="alternate" href="https://tools.yuchani.com/ja/base64" hreflang="ja" />
  <link rel="alternate" href="https://tools.yuchani.com/base64" hreflang="x-default" />

  <!-- JSON-LD: WebApplication -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Base64 변환",
    "url": "https://tools.yuchani.com/base64",
    "applicationCategory": "DeveloperApplication",
    "operatingSystem": "Web",
    "offers": {"@type": "Offer", "price": "0", "priceCurrency": "KRW"},
    "description": "텍스트/파일 Base64 인코딩·디코딩, URL-safe/패딩 옵션, 복사·다운로드 지원.",
    "creator": {"@type": "Organization", "name": "Yuchani Tools pro"}
  }
  </script>

  <!-- JSON-LD: FAQPage (SEO) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {"@type": "Question", "name": "서버로 업로드되나요?", "acceptedAnswer": {"@type":"Answer","text":"아니요. 모든 변환은 브라우저 내부에서 수행됩니다."}},
      {"@type": "Question", "name": "URL-safe는 뭔가요?", "acceptedAnswer": {"@type":"Answer","text":"Base64에서 + / 를 - _ 로 바꾸고, 필요시 = 패딩을 제거해 URL에 안전하게 넣는 표기입니다."}},
      {"@type": "Question", "name": "파일은 어떻게 디코딩하나요?", "acceptedAnswer": {"@type":"Answer","text":"Base64 문자열을 디코딩해 파일로 다운로드할 수 있고, 파일명/확장자를 지정할 수 있습니다."}}
    ]
  }
  </script>

  <!-- JSON-LD: HowTo (사용설명서, SEO) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "Base64 변환 사용설명서",
    "description": "텍스트·파일을 Base64로 인코딩하거나 디코딩하는 단계별 안내.",
    "step": [
      {"@type":"HowToStep","name":"모드 선택","text":"인코딩 또는 디코딩을 선택합니다."},
      {"@type":"HowToStep","name":"입력 제공","text":"텍스트를 붙여넣거나 파일을 선택합니다."},
      {"@type":"HowToStep","name":"옵션 설정","text":"URL-safe/패딩/줄바꿈 등을 선택합니다."},
      {"@type":"HowToStep","name":"결과 확인","text":"오른쪽 결과 영역에서 즉시 확인합니다."},
      {"@type":"HowToStep","name":"복사/다운로드","text":"결과를 복사하거나 파일로 저장합니다."}
    ]
  }
  </script>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { color-scheme: dark; }
    body { background:#0F1113; }
    .slim-scroll::-webkit-scrollbar{ height:10px; width:10px }
    .slim-scroll::-webkit-scrollbar-thumb{ background:#2a2f36; border-radius:8px }
  </style>
</head>
<body class="text-white">
  <!-- Header -->
  <header class="sticky top-0 z-30 backdrop-blur supports-[backdrop-filter]:bg-[#0F1113]/70">
    <div class="mx-auto max-w-7xl px-4">
      <div class="flex h-16 items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="grid h-9 w-9 place-items-center rounded-xl bg-gradient-to-br from-emerald-400/80 to-teal-500/80 shadow-[0_6px_30px_-10px_rgba(16,185,129,0.7)]">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5 4l7 7 7-7" stroke="black" stroke-width="2.2" stroke-linecap="round"/>
              <path d="M12 11v9" stroke="black" stroke-width="2.2" stroke-linecap="round"/>
            </svg>
          </div>
          <span class="text-lg font-semibold tracking-tight bg-gradient-to-r from-emerald-300 to-teal-400 bg-clip-text text-transparent">Yuchani Tools pro</span>
        </div>
        <nav class="flex items-center gap-2">
          <a href="/" class="rounded-xl border border-white/15 px-3 py-2 text-sm text-white/80 hover:border-white/25 hover:text-white">메인</a>
          <a href="#docs" class="rounded-xl border border-white/15 px-3 py-2 text-sm text-white/80 hover:border-white/25 hover:text-white">문서</a>
        </nav>
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-7xl px-4 pb-24">
    <!-- Breadcrumb -->
    <nav class="pt-6 text-sm text-white/60">
      <ol class="flex flex-wrap items-center gap-2">
        <li><a class="hover:text-white/90" href="/">홈</a></li>
        <li>/</li>
        <li><a class="hover:text-white/90" href="/dev-tools">코딩/웹</a></li>
        <li>/</li>
        <li class="text-white">Base64 변환</li>
      </ol>
    </nav>

    <!-- Hero -->
    <section class="py-6 md:py-10">
      <div class="rounded-3xl border border-white/10 bg-gradient-to-br from-white/5 to-white/0 p-6 md:p-8">
        <div class="flex flex-col gap-6 md:flex-row md:items-end md:justify-between">
          <div>
            <h1 class="text-2xl font-bold tracking-tight md:text-3xl">Base64 변환</h1>
            <p class="mt-2 max-w-2xl text-white/75">텍스트·파일을 Base64로 인코딩하거나, Base64 문자열을 디코딩해 원본으로 복원합니다. 모든 처리는 브라우저에서 안전하게 수행됩니다.</p>
          </div>
          <div class="flex gap-2">
            <button id="insertSample" class="rounded-xl border border-white/15 px-3 py-2 text-sm text-white/80 hover:border-white/25 hover:text-white">샘플</button>
            <button id="clearAll" class="rounded-xl border border-white/15 px-3 py-2 text-sm text-white/80 hover:border-white/25 hover:text-white">초기화</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Main 2-column tool -->
    <section class="grid grid-cols-1 gap-4 lg:grid-cols-2">
      <!-- 입력 (노랑 테두리) -->
      <div class="rounded-2xl border-2 border-yellow-300/40 bg-white/5 p-5">
        <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
          <div class="text-sm font-medium text-yellow-200/90">입력</div>
          <div class="flex flex-wrap items-center gap-3 text-xs text-white/70">
            <label class="inline-flex items-center gap-1 cursor-pointer"><input id="autoUpdate" type="checkbox" class="accent-emerald-400" checked> 자동 업데이트</label>
            <label class="inline-flex items-center gap-1 cursor-pointer"><input id="detectMode" type="checkbox" class="accent-emerald-400" checked> 자동 감지</label>
          </div>
        </div>

        <div class="mt-3 grid grid-cols-1 gap-4 md:grid-cols-2">
          <div class="space-y-3">
            <label class="block text-sm text-white/75">모드</label>
            <div class="grid grid-cols-2 gap-2 text-sm">
              <button id="modeEncode" class="mode-btn rounded-xl border border-white/15 px-3 py-2 data-[active=true]:bg-white data-[active=true]:text-black">인코딩</button>
              <button id="modeDecode" class="mode-btn rounded-xl border border-white/15 px-3 py-2">디코딩</button>
            </div>

            <div>
              <label class="block text-sm text-white/75">텍스트 입력</label>
              <textarea id="inputText" class="slim-scroll mt-1 h-[32vh] w-full resize-y rounded-xl border border-white/15 bg-black/40 p-3 font-mono text-sm leading-[1.5] outline-none placeholder:text-white/40 focus:border-white/25" placeholder="텍스트를 입력하거나 아래에서 파일을 선택하세요"></textarea>
            </div>

            <div class="grid grid-cols-1 gap-2 md:grid-cols-2">
              <div>
                <label class="block text-sm text-white/75">파일 선택</label>
                <input id="fileInput" type="file" class="mt-1 w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm file:mr-3 file:rounded-lg file:border-0 file:bg-white/10 file:px-3 file:py-2 file:text-white/80 hover:file:bg-white/20" />
              </div>
              <div>
                <label class="block text-sm text-white/75">디코드 파일명</label>
                <input id="outFilename" placeholder="decoded.bin" class="mt-1 w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm focus:border-white/25" />
              </div>
            </div>

            <div class="grid grid-cols-2 gap-3 md:grid-cols-3 text-sm text-white/80">
              <label class="inline-flex items-center gap-2"><input id="optUrlSafe" type="checkbox" class="accent-emerald-400"> URL-safe</label>
              <label class="inline-flex items-center gap-2"><input id="optNoPadding" type="checkbox" class="accent-emerald-400"> 패딩 제거</label>
              <label class="inline-flex items-center gap-2"><input id="optWrap" type="checkbox" class="accent-emerald-400"> 76자 줄바꿈</label>
            </div>

            <div class="flex flex-wrap items-center gap-2 text-sm text-white/70">
              <button id="copyInput" class="rounded-lg border border-white/15 px-3 py-2 hover:border-white/25">입력 복사</button>
              <button id="pasteInput" class="rounded-lg border border-white/15 px-3 py-2 hover:border-white/25">입력 붙여넣기</button>
            </div>
          </div>

          <div class="space-y-3">
            <label class="block text-sm text-white/75">상태</label>
            <div id="status" class="rounded-xl border border-white/10 bg-white/5 p-3 text-sm text-white/80">대기 중…</div>
            <div class="text-xs text-white/50">파일 우선: 파일을 선택하면 텍스트 대신 파일이 처리됩니다.</div>
          </div>
        </div>
      </div>

      <!-- 결과 (파랑 테두리) -->
      <div class="rounded-2xl border-2 border-sky-300/40 bg-white/5 p-5">
        <div class="flex items-center justify-between">
          <div class="text-sm font-medium text-sky-200/90">결과</div>
          <div class="flex flex-wrap items-center gap-2 text-sm">
            <button id="copyOutput" class="rounded-lg border border-white/15 px-3 py-2 hover:border-white/25">복사</button>
            <button id="downloadOutput" class="rounded-lg border border-white/15 px-3 py-2 hover:border-white/25">다운로드</button>
            <button id="openNewTab" class="rounded-lg bg-white px-3 py-2 text-black hover:-translate-y-0.5">새 탭</button>
          </div>
        </div>
        <textarea id="outputText" class="slim-scroll mt-3 h-[48vh] w-full resize-y rounded-xl border border-white/10 bg-black/40 p-3 font-mono text-sm leading-[1.5] outline-none" readonly></textarea>
        <p class="mt-3 text-center text-xs text-white/60">노트: 모든 변환은 로컬 브라우저에서 수행됩니다. 데이터는 서버로 전송되지 않습니다.</p>
      </div>
    </section>

    <!-- 사용설명서 -->
    <section class="mt-4 grid grid-cols-1 gap-4 lg:grid-cols-3">
      <div class="rounded-2xl border-2 border-emerald-300/40 bg-white/5 p-5 lg:col-span-2">
        <div class="text-sm font-medium text-emerald-200/90">사용설명서</div>
        <ol class="mt-3 space-y-3 pl-5 text-sm text-white/80 list-decimal">
          <li><span class="font-medium text-white">모드 선택:</span> 상단에서 인코딩/디코딩을 선택합니다. 기본은 자동감지로 문자열을 분석합니다.</li>
          <li><span class="font-medium text-white">입력 제공:</span> 텍스트 영역에 입력하거나 파일을 선택합니다. 파일이 있으면 파일 우선으로 처리됩니다.</li>
          <li><span class="font-medium text-white">옵션:</span> URL-safe(+-→-_, /=제거) · 패딩 제거(=) · 76자 줄바꿈을 필요에 따라 적용합니다.</li>
          <li><span class="font-medium text-white">결과 확인:</span> 오른쪽 결과를 확인하고 복사/다운로드/새 탭 열기를 사용합니다.</li>
          <li><span class="font-medium text-white">디코딩 파일 저장:</span> 디코딩 모드에서는 파일명 입력 후 다운로드하면 원본 바이트로 저장됩니다.</li>
        </ol>
        <p class="mt-3 text-xs text-white/60">팁: Data URL 형식(<code>data:image/png;base64,....</code>)도 자동으로 디코딩되어 파일로 저장할 수 있습니다.</p>
      </div>
      <div class="rounded-2xl border border-white/10 bg-white/5 p-5">
        <div class="text-sm font-medium">빠른 체크</div>
        <ul class="mt-3 space-y-2 text-sm text-white/75">
          <li>✅ URL에 넣을 땐 <span class="text-emerald-300">URL-safe</span> 사용</li>
          <li>✅ 메일 전송 호환 위해 <span class="text-emerald-300">76자 줄바꿈</span> 옵션</li>
          <li>✅ 파일 디코딩 시 <span class="text-emerald-300">파일명</span> 지정</li>
        </ul>
      </div>
    </section>

    <!-- SEO 고정 정보 -->
    <section class="mt-6 rounded-2xl border border-white/10 bg-white/5 p-5">
      <div class="flex flex-wrap items-center justify-between gap-3">
        <div class="text-sm text-white/70">JSON-LD • hreflang • canonical • 무료가격(0) • 메타 설명</div>
        <a href="#docs" class="rounded-xl border border-white/15 px-3 py-2 text-sm text-white/80 hover:border-white/25 hover:text-white">구현 가이드</a>
      </div>
    </section>
  </main>

  <!-- Footer (로고 라인 없이, 고급 버튼 그리드만) -->
  <footer class="border-t border-white/10 py-12 text-sm text-white/70">
    <div class="mx-auto max-w-7xl px-4">
      <div class="mt-6 grid grid-cols-2 gap-3 sm:grid-cols-4">
        <a href="https://yuchani.com" target="_blank" rel="noreferrer noopener" aria-label="yuchani website (블로그)" class="group relative rounded-2xl border border-white/10 bg-white/[0.04] px-4 py-3 backdrop-blur transition hover:-translate-y-0.5 hover:border-white/25 hover:bg-white/[0.06]">
          <div class="flex items-center gap-2">
            <span class="grid h-8 w-8 place-items-center rounded-xl bg-gradient-to-br from-emerald-400/70 to-teal-500/70 shadow-[0_8px_30px_-12px_rgba(16,185,129,0.6)]">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="black" stroke-width="1.6"/><path d="M2 12h20M12 2c3 3 3 17 0 20M12 2c-3 3-3 17 0 20" stroke="black" stroke-width="1.6"/></svg>
            </span>
            <div>
              <div class="font-medium text-white">yuchani website</div>
              <div class="text-xs text-white/55">블로그 · yuchani.com</div>
            </div>
          </div>
        </a>
        <a href="https://bloodmenlife.com" target="_blank" rel="noreferrer noopener" aria-label="boolmenlife website (블로그)" class="group relative rounded-2xl border border-white/10 bg-white/[0.04] px-4 py-3 backdrop-blur transition hover:-translate-y-0.5 hover:border-white/25 hover:bg-white/[0.06]">
          <div class="flex items-center gap-2">
            <span class="grid h-8 w-8 place-items-center rounded-xl bg-gradient-to-br from-sky-400/70 to-indigo-500/70 shadow-[0_8px_30px_-12px_rgba(56,189,248,0.6)]">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="black" stroke-width="1.6"/><path d="M2 12h20M12 2c3 3 3 17 0 20M12 2c-3 3-3 17 0 20" stroke="black" stroke-width="1.6"/></svg>
            </span>
            <div>
              <div class="font-medium text-white">boolmenlife website</div>
              <div class="text-xs text-white/55">블로그 · bloodmenlife.com</div>
            </div>
          </div>
        </a>
        <a href="https://open.kakao.com/me/yuchani_x" target="_blank" rel="noreferrer noopener" aria-label="관리자 카카오톡" class="group relative rounded-2xl border border-white/10 bg-white/[0.04] px-4 py-3 backdrop-blur transition hover:-translate-y-0.5 hover:border-white/25 hover:bg-white/[0.06]">
          <div class="flex items-center gap-2">
            <span class="grid h-8 w-8 place-items-center rounded-xl bg-gradient-to-br from-yellow-300/80 to-amber-500/80 shadow-[0_8px_30px_-12px_rgba(251,191,36,0.6)]">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 5c-4.5 0-8.5 2.7-8.5 6s4 6 8.5 6c.8 0 1.6-.1 2.4-.3L20.2 20l-1.5-3c.8-1 .8-1.9.8-3 0-3.3-3.5-6-7.5-6Z" fill="black"/><path d="M8.2 12.2h7.6" stroke="#FFC801" stroke-width="1.8" stroke-linecap="round"/></svg>
            </span>
            <div>
              <div class="font-medium text-white">관리자 카카오톡</div>
              <div class="text-xs text-white/55">open.kakao.com/me/yuchani_x</div>
            </div>
          </div>
        </a>
        <a href="https://qr.kakaopay.com/FcRGwQ7nE" target="_blank" rel="noreferrer noopener" aria-label="카카오페이 후원" class="group relative rounded-2xl border border-white/10 bg-white/[0.04] px-4 py-3 backdrop-blur transition hover:-translate-y-0.5 hover:border-white/25 hover:bg-white/[0.06]">
          <div class="flex items-center gap-2">
            <span class="grid h-8 w-8 place-items-center rounded-xl bg-gradient-to-br from-yellow-300/85 to-yellow-400/85 shadow-[0_8px_30px_-12px_rgba(251,191,36,0.65)]">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="5" width="18" height="14" rx="3" fill="black"/><text x="12" y="14" font-size="7" font-weight="800" text-anchor="middle" fill="#FFC801">pay</text></svg>
            </span>
            <div>
              <div class="font-medium text-white">카카오페이 후원</div>
              <div class="text-xs text-white/55">qr.kakaopay.com/FcRGwQ7nE</div>
            </div>
          </div>
        </a>
      </div>
    </div>
  </footer>

  <script>
    const $ = (s)=>document.querySelector(s);
    const inputText = $('#inputText');
    const outputText = $('#outputText');
    const fileInput = $('#fileInput');
    const outFilename = $('#outFilename');
    const autoUpdate = $('#autoUpdate');
    const detectMode = $('#detectMode');
    const modeEncodeBtn = $('#modeEncode');
    const modeDecodeBtn = $('#modeDecode');
    const optUrlSafe = $('#optUrlSafe');
    const optNoPadding = $('#optNoPadding');
    const optWrap = $('#optWrap');
    const statusBox = $('#status');

    let mode = 'encode';

    function setMode(m){
      mode = m;
      modeEncodeBtn.dataset.active = (m==='encode');
      modeDecodeBtn.dataset.active = (m==='decode');
      status('모드: ' + (m==='encode'?'인코딩':'디코딩'));
      if(autoUpdate.checked) transform();
    }

    modeEncodeBtn.addEventListener('click', ()=> setMode('encode'));
    modeDecodeBtn.addEventListener('click', ()=> setMode('decode'));

    function status(msg){ statusBox.textContent = msg; }

    function utf8ToBase64(str){
      return btoa(unescape(encodeURIComponent(str)));
    }
    function base64ToUtf8(b64){
      return decodeURIComponent(escape(atob(b64)));
    }

    function isLikelyBase64(s){
      // 허술하지만 실용적인 감지: 공백 제거, URL-safe도 허용
      const t = (s||'').trim().replace(/\s+/g,'');
      if(!t) return false;
      const u = t.replace(/[-_]/g, m=> m==='-'?'+':'/');
      if(/[^A-Za-z0-9+/=]/.test(u)) return false;
      try{ atob(u.replace(/=/g,'')); return true; }catch(e){ return false; }
    }

    function wrap76(s){ return s.replace(/.{1,76}/g, '$&\n').trim(); }

    async function fileToBase64(file){
      const buf = await file.arrayBuffer();
      let binary = '';
      const bytes = new Uint8Array(buf);
      for(let i=0;i<bytes.length;i++){ binary += String.fromCharCode(bytes[i]); }
      return btoa(binary);
    }

    function buildB64Options(b64){
      let out = b64;
      if(optUrlSafe.checked){ out = out.replace(/\+/g,'-').replace(/\//g,'_'); }
      if(optNoPadding.checked){ out = out.replace(/=+$/,''); }
      if(optWrap.checked){ out = wrap76(out); }
      return out;
    }

    function normalizeB64ForDecode(s){
      let t = (s||'').trim();
      // data URL 처리
      const m = t.match(/^data:([^;]+);base64,(.*)$/);
      if(m){ t = m[2]; }
      t = t.replace(/\s+/g,'').replace(/-/g,'+').replace(/_/g,'/');
      // 패딩 보정
      const pad = t.length % 4; if(pad===2) t += '=='; else if(pad===3) t += '='; else if(pad!==0 && !optNoPadding.checked) t += '===';
      return t;
    }

    async function transform(){
      // 파일 우선
      if(fileInput.files && fileInput.files[0]){
        const f = fileInput.files[0];
        if(mode==='encode'){
          const b64 = await fileToBase64(f);
          outputText.value = buildB64Options(b64);
          status(`파일 인코딩 완료: ${f.name} (${(f.size/1024).toFixed(1)} KB)`);
        } else {
          status('파일 디코딩은 텍스트 영역의 Base64를 사용합니다. 파일을 제거하거나 텍스트를 붙여넣으세요.');
        }
        return;
      }

      const src = inputText.value || '';
      if(!src){ outputText.value=''; status('대기 중…'); return; }

      let op = mode;
      if(detectMode.checked){ op = isLikelyBase64(src) ? 'decode' : 'encode'; }

      try{
        if(op==='encode'){
          const b64 = utf8ToBase64(src);
          outputText.value = buildB64Options(b64);
          status('인코딩 완료');
        } else {
          const norm = normalizeB64ForDecode(src);
          const text = base64ToUtf8(norm);
          outputText.value = text;
          status('디코딩 완료 (텍스트)');
        }
      }catch(e){
        outputText.value = '';
        status('에러: 유효하지 않은 입력입니다.');
      }
    }

    // 이벤트 바인딩 (디바운스)
    let t; const debounce = fn=>{ clearTimeout(t); t=setTimeout(fn, 200); };
    [inputText].forEach(el=> el.addEventListener('input', ()=> autoUpdate.checked && debounce(transform)));
    [optUrlSafe,optNoPadding,optWrap,detectMode].forEach(el=> el.addEventListener('change', ()=> autoUpdate.checked && transform()));
    [modeEncodeBtn,modeDecodeBtn].forEach(el=> el.addEventListener('click', ()=> autoUpdate.checked && transform()));
    fileInput.addEventListener('change', ()=> transform());

    // Controls
    $('#copyInput').addEventListener('click', async ()=>{ await navigator.clipboard.writeText(inputText.value||''); status('입력 복사됨'); });
    $('#pasteInput').addEventListener('click', async ()=>{ inputText.value = await navigator.clipboard.readText(); transform(); });
    $('#copyOutput').addEventListener('click', async ()=>{ await navigator.clipboard.writeText(outputText.value||''); status('결과 복사됨'); });

    $('#downloadOutput').addEventListener('click', async ()=>{
      if(mode==='decode' || (detectMode.checked && isLikelyBase64(inputText.value))){
        // 디코딩 결과를 파일로 저장 (바이너리)
        try{
          const norm = normalizeB64ForDecode(inputText.value||'');
          const bin = atob(norm);
          const bytes = new Uint8Array(bin.length);
          for(let i=0;i<bin.length;i++) bytes[i] = bin.charCodeAt(i);
          const blob = new Blob([bytes.buffer], {type:'application/octet-stream'});
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url; a.download = (outFilename.value||'decoded.bin');
          document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
          status('파일 다운로드 완료');
        }catch(e){ status('에러: 디코딩 실패'); }
      } else {
        // 텍스트 결과를 .txt로 저장
        const blob = new Blob([outputText.value||''], {type:'text/plain;charset=utf-8'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'base64.txt';
        document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
        status('텍스트 다운로드 완료');
      }
    });

    $('#openNewTab').addEventListener('click', ()=>{
      const w = window.open('', '_blank', 'noopener,noreferrer');
      if(!w) return;
      const pre = document.createElement('pre'); pre.style.whiteSpace='pre-wrap'; pre.textContent = outputText.value||'';
      w.document.title = 'Base64 결과'; w.document.body.appendChild(pre);
    });

    // 초기값
    const SAMPLE_TEXT = '안녕하세요, Base64! 👋';
    inputText.value = SAMPLE_TEXT;
    setMode('encode');
    transform();
  </script>
</body>
</html>
